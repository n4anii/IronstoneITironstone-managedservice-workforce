[string]$(Get-ItemProperty -Path ('Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CloudDomainJoin\JoinInfo\{0}' -f ((Get-ChildItem -Path 'Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CloudDomainJoin\JoinInfo' -ErrorAction 'SilentlyContinue' | Select-Object -First 1 -ExpandProperty 'Name').Split('\')[-1])) -Name 'UserEmail' -ErrorAction 'SilentlyContinue' | Select-Object -ExpandProperty 'UserEmail')